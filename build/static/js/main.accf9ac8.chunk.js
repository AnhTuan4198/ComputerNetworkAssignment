(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{101:function(e,t,a){},102:function(e,t,a){},103:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},118:function(e,t){},120:function(e,t){},141:function(e,t,a){},142:function(e,t,a){},143:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),i=a(62),r=a.n(i),c=a(4),l=a(5),o=a(7),u=a(6),m=a(63),h=a.n(m),d=a(3),p=a(15),f=a(2),v=(a(101),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=n.props.socket,a=n.state.nickname;t.emit(d.VERIFY_USER,a,n.setUser)},n.handlOnchange=function(e){n.setState(Object(p.a)({},e.target.name,e.target.value))},n.setUser=function(e){var t=e.user;e.logined?n.setError("Nickname already taken"):(n.setError(""),n.props.setUser(t))},n.setError=function(e){n.setState({error:e})},n.state={nickname:"",error:null},n.handleSubmit=n.handleSubmit.bind(Object(f.a)(n)),n.handlOnchange=n.handlOnchange.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=(e.nickname,e.error);return s.a.createElement("div",{className:"LoginArea"},s.a.createElement("form",{onSubmit:this.handleSubmit,id:"Login-form"},s.a.createElement("h2",null,"Welcome"),s.a.createElement("label",{htmlFor:"nickname"},s.a.createElement("h2",null,"Don't have nickname?")),s.a.createElement("input",{id:"nickname",name:"nickname",type:"text",placeholder:"Get cool nickname here ",autoComplete:"off",onChange:this.handlOnchange}),s.a.createElement("div",{id:"error"},t||null),s.a.createElement("button",{disabled:this.state.nickname.length<1,className:"btn",type:"submit"},"GO!!")))}}]),a}(n.Component)),E=a(20),g=(a(102),a(32)),b=a(65),C=a(64),S=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={receiver:"",showUserList:!1,ConnecttingUser:[]},n.handleChange=n.handleChange.bind(Object(f.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getConnectingList()}},{key:"handleChange",value:function(e){this.setState(Object(p.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.openPrivateChat(this.state.receiver),this.setState({receiver:""})}},{key:"getConnectingList",value:function(){var e=this;this.props.socket.on(d.USER_CONNECTED,(function(t){var a=Object.entries(t);e.setState({ConnecttingUser:Object(E.a)(a)})}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.logout,i=t.chats,r=t.activeChat,c=t.setActivechat,l=this.state.ConnecttingUser;return s.a.createElement("div",{className:"Sidebar-container"},s.a.createElement("div",{className:"Sidebar-heading"},s.a.createElement("div",{className:"App-name"},"Cool Chat App"),s.a.createElement("div",{className:"heading-menu"},s.a.createElement(g.a,null))),s.a.createElement("div",{className:"Sidebar-option"},s.a.createElement("div",{className:"Show-Chat-List",onClick:function(){e.setState({showUserList:!1})}},"Chat List"),s.a.createElement("div",{className:"Show-Online-User",onClick:function(){e.setState({showUserList:!0})}},"Online User")),s.a.createElement("div",{className:"Sidebar-search"},s.a.createElement("form",{onSubmit:this.handleSubmit,className:"Search-form"},s.a.createElement("input",{className:"Search-input",placeholder:"Search for connecting user",type:"text",name:"receiver",autoComplete:"off",value:this.state.receiver,onChange:this.handleChange}),s.a.createElement("button",{className:"plus",type:"submit",disabled:this.state.receiver.length<1},s.a.createElement(C.a,null)))),s.a.createElement("div",{className:"Sidebar-list"},this.state.showUserList?s.a.createElement("div",{className:"Sidebar-user-list"},l.map((function(t){if(t[0]!==a.name)return s.a.createElement("div",{onClick:function(){e.setState({showUserList:!1}),e.props.openPrivateChat(t[0])},key:t[1].id,className:"UserList-UserItem"},t[0])}))):s.a.createElement("div",{className:"Sidebar-chat-list",onClick:function(t){t.target===e.refs.user&&c(null)}},i.map((function(e){if(e.name){var t=e.messages[e.messages.length-1],n=e.users.find((function(e){return e!==a.name}))||"Community",i=r&&r.id===e.id?"active":"";return s.a.createElement("div",{key:e.id,className:"user ".concat(i),onClick:function(){return c(e)}},s.a.createElement("div",{className:"user-ava"},n[0].toUpperCase()),s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"user-name"},n),t&&s.a.createElement("div",{className:"lastMessage"},t.message)))}return null})))),s.a.createElement("div",{className:"Sidebar-current-user"},s.a.createElement("div",{className:"current-user-name"},a.name),s.a.createElement("div",{id:"logout",onClick:function(){n()}},s.a.createElement(b.a,null))))}}]),a}(n.Component),k=(a(51),a(103),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).scrollDown=function(){var e=n.messageList.current.scrollHeight-n.messageList.current.clientHeight;n.messageList.current.scrollTop=e>0?e:0},n.messageList=s.a.createRef(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.scrollDown()}},{key:"componentDidUpdate",value:function(){this.scrollDown()}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.messages,n=e.typingUsers,i=a.map((function(e){return e.link?s.a.createElement("div",{key:e.id,className:"message ".concat(e.sender===t.name?"right":"")},s.a.createElement("div",{className:"content"},s.a.createElement("a",{href:e.fileURL,download:e.fileName,target:"_blank"},e.fileName)),s.a.createElement("div",{className:"info"},s.a.createElement("div",{className:"Time"},e.time),s.a.createElement("div",{className:"sender"},e.sender))):s.a.createElement("div",{key:e.id,className:"message ".concat(e.sender===t.name?"right":"")},s.a.createElement("div",{className:"content"},e.message),s.a.createElement("div",{className:"info"},s.a.createElement("div",{className:"Time"},e.time),s.a.createElement("div",{className:"sender"},e.sender)))})),r=n.map((function(e){return s.a.createElement("div",{key:e,className:"typing-status"},"".concat(e),s.a.createElement("span",null," "),s.a.createElement("span",null,"i"),s.a.createElement("span",null,"s"),s.a.createElement("span",null," "),s.a.createElement("span",null,"t"),s.a.createElement("span",null,"y"),s.a.createElement("span",null,"p"),s.a.createElement("span",null,"i"),s.a.createElement("span",null,"n"),s.a.createElement("span",null,"g"),s.a.createElement("span",null,"."),s.a.createElement("span",null,"."),s.a.createElement("span",null,"."))}));return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"thread",ref:this.messageList},i,r))}}]),a}(n.Component)),y=a(34),N=(a(52),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handlChange=function(e){n.setState(Object(p.a)({},e.target.name,e.target.value))},n.state={message:"",isTyping:!1},n.handleSubmit=n.handleSubmit.bind(Object(f.a)(n)),n.handlChange=n.handlChange.bind(Object(f.a)(n)),n.handleSendFileForm=n.handleSendFileForm.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.sendMessage(),this.setState({message:""})}},{key:"sendMessage",value:function(){var e=this.state.message;console.log(e),this.props.sendMessage(e)}},{key:"sendTyping",value:function(){this.lastUpdate=Date.now(),this.state.isTyping||(this.setState({isTyping:!0}),this.props.sendTyping(!0),this.startCheckTyping())}},{key:"startCheckTyping",value:function(){var e=this;console.log("Typing"),this.typingInterval=setInterval((function(){Date.now()-e.lastUpdate>300&&(e.setState({isTyping:!1}),e.stopCheckTyping())}),3e3)}},{key:"stopCheckTyping",value:function(){console.log("Stop Typing"),this.typingInterval&&(clearInterval(this.typingInterval),this.props.sendTyping(!1))}},{key:"handleSendFileForm",value:function(){console.log("showform"),this.props.showSendFileForm()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"Message-input"},s.a.createElement("form",{className:"form",onSubmit:this.handleSubmit},s.a.createElement("input",{id:"message",name:"message",type:"text",autoComplete:"off",value:this.state.message,placeholder:"Type some thing interresting here",onKeyUp:function(t){13!==t.keyCode&&e.sendTyping()},onChange:this.handlChange}),s.a.createElement("button",{className:"btn",disabled:this.state.message.length<1,type:"submit"},s.a.createElement(y.b,null))),s.a.createElement("button",{className:"file-btn",onClick:this.handleSendFileForm},s.a.createElement(y.a,null)))}}]),a}(n.Component)),O=a(35),T=a.n(O),F=a(66),U=(a(105),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={fileName:"",buffer:[],type:""},n.handleSubmitfile=n.handleSubmitfile.bind(Object(f.a)(n)),n.handleChangeFile=n.handleChangeFile.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"handleSubmitfile",value:function(e){e.preventDefault(),this.props.sendFile({fileName:this.state.fileName,buffer:this.state.buffer,type:this.state.type}),this.setState({fileName:"",buffer:[],type:""}),this.props.showSendFileForm()}},{key:"handleChangeFile",value:function(){var e=Object(F.a)(T.a.mark((function e(){var t,a,n=this;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=document.querySelector("input[type=file]"),console.log(t.files[0]),(a=new FileReader).onload=function(){n.setState({fileName:t.files[0].name,buffer:[a.result],type:t.files[0].type}),console.log(n.state)},a.readAsArrayBuffer(t.files[0]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",{className:"file-form"},s.a.createElement("form",{onSubmit:this.handleSubmitfile},s.a.createElement("button",{className:"cancle-btn",onClick:this.props.showSendFileForm},"X"),s.a.createElement("input",{type:"file",onChange:this.handleChangeFile}),s.a.createElement("button",{className:"btn",type:"submit"},"Send")))}}]),a}(n.Component)),j=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={showSendFileForm:!1},n.showSendFileForm=n.showSendFileForm.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"showSendFileForm",value:function(){this.setState({showSendFileForm:!this.state.showSendFileForm}),console.log(this.state.showSendFileForm)}},{key:"render",value:function(){var e=this.props,t=e.activeChat,a=e.user,n=e.sendMessage,i=e.sendTyping,r=e.sendFile;return s.a.createElement("div",{className:"Chat-Console-container"},s.a.createElement("div",{className:"console-heading"},t.name),s.a.createElement(k,{user:a,messages:t.messages,typingUsers:t.typingUsers}),s.a.createElement(N,{sendMessage:function(e){n(t.id,e)},sendTyping:function(e){i(t.id,e)},showSendFileForm:this.showSendFileForm}),this.state.showSendFileForm?s.a.createElement(U,{sendFile:function(e){r(t.id,e)},showSendFileForm:this.showSendFileForm}):null)}}]),a}(n.Component),w=(a(106),a(33)),I=a.n(w),L=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).resetChat=function(e){return n.addChat(e,!0)},n.addChat=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=n.props,s=a.socket,i=(a.p2psocket,n.state.chats),r=t?[e]:[].concat(Object(E.a)(i),[e]);n.setState({chats:r,activeChat:t?e:n.state.activeChat});var c="".concat(d.MESSAGE_RECEIVED,"-").concat(e.id),l="".concat(d.TYPING,"-").concat(e.id),o="".concat(d.FILE_RECEIVED,"-").concat(e.id);s.on(c,n.addMessagetoChat(e.id)),s.on(l,n.updateTyping(e.id)),s.on(o,n.addLinkToChat(e.id))},n.addMessagetoChat=function(e){return function(t){var a=n.state.chats.map((function(a){return a.id===e&&a.messages.push(t),a}));n.setState({chats:a})}},n.addLinkToChat=function(e){return function(t){var a=new Blob(t.buffer,{type:t.type}),s=(URL||window.webkitURL).createObjectURL(a),i=n.state.chats.map((function(a){return a.id==e&&a.messages.push({fileURL:s,id:t.id,sender:t.sender,link:!0,fileName:t.fileName}),a}));n.setState({chats:i})}},n.updateTyping=function(e){return function(t){var a=t.isTyping,s=t.user;if(s!==n.props.user.name){var i=n.state.chats.map((function(t){return t.id===e&&(a&&!t.typingUsers.includes(s)?t.typingUsers.push(s):!a&&t.typingUsers.includes(s)&&(t.typingUsers=t.typingUsers.filter((function(e){return e!==s})))),t}));n.setState({chats:i})}}},n.setActivechat=function(e){n.setState({activeChat:e})},n.sendFile=function(e,t){n.props.socket.emit(d.FILE_SENT,{chatId:e,data:t})},n.sendMessage=function(e,t){n.props.socket.emit(d.MESSAGE_SENT,{chatId:e,message:t})},n.sendTyping=function(e,t){var a=n.props,s=a.socket;a.p2psocket;s.emit(d.TYPING,{chatId:e,isTyping:t})},n.state={chats:[],activeChat:null},n.sendPrivateChat=n.sendPrivateChat.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.socket;this.initSocket(e)}},{key:"initSocket",value:function(e){var t=this,a=this.props;a.user,a.p2psocket;e.emit(d.COMMUNITY_CHAT,this.resetChat),e.on(d.PRIVATE_CHAT,this.addChat),e.on("connect",(function(){e.emit(d.COMMUNITY_CHAT,t.resetChat)}))}},{key:"sendPrivateChat",value:function(e){var t=this.props,a=t.socket,n=t.user,s=this.state.activeChat;a.emit(d.PRIVATE_CHAT,{receiver:e,user:n.name,activeChat:s})}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.logout,n=e.socket,i=this.state,r=i.chats,c=i.activeChat;return s.a.createElement("div",{className:"Chat-container"},s.a.createElement("div",{className:"side-bar"},s.a.createElement(S,{user:t,logout:a,chats:r,activeChat:c,setActivechat:this.setActivechat,openPrivateChat:this.sendPrivateChat,socket:n})),s.a.createElement("div",{className:"welcome-window"},null!==c?s.a.createElement(j,{user:t,activeChat:c,sendTyping:this.sendTyping,sendMessage:this.sendMessage,sendFile:this.sendFile}):s.a.createElement("div",null,s.a.createElement("h1",null,"Welcome to chat app "))))}}]),a}(n.Component),_=(a(141),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).initSocket=function(){var e=h()("/"),t=new I.a(e,{peerOpts:{trickle:!1},autoUpgrade:!1,usePeerConnection:!0});e.on("connect",(function(){console.log("Connected")})),n.setState({socket:e,p2psocket:t})},n.setUser=function(e){n.state.socket.emit(d.USER_CONNECTED,e),n.setState({user:e})},n.logout=function(){n.state.socket.emit(d.LOG_OUT,n.state.user.name),n.setState({user:null})},n.state={socket:null,p2psocket:null,user:null},n}return Object(l.a)(a,[{key:"componentWillMount",value:function(){this.initSocket()}},{key:"render",value:function(){var e=this.state,t=e.socket,a=e.user,n=e.p2psocket;return s.a.createElement("div",{className:"Layout-container"},a?s.a.createElement(L,{p2psocket:n,socket:t,user:a,logout:this.logout}):s.a.createElement(v,{socket:t,setUser:this.setUser}))}}]),a}(n.Component));a(142);var M=function(){return setInterval((function(){return!1}),500),s.a.createElement("div",{className:"App"},s.a.createElement(_,{title:"Let do it"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},3:function(e,t){e.exports={COMMUNITY_CHAT:"COMMUNITY_CHAT",MESSAGE_RECEIVED:"MESSAGE_RECEIVED",MESSAGE_SENT:"MESSAGE_SENT",USER_CONNECTED:"USER_CONNECTED",USER_DISCONNECTED:"USER_DISCONNECTED",TYPING:"TYPING",VERIFY_USER:"VERIFY_USER",LOG_OUT:"LOG_OUT",PRIVATE_CHAT:"PRIVATE_CHAT",FILE_SENT:"FILE_SENT",FILE_RECEIVED:"FILE_RECEIVED"}},51:function(e,t,a){},52:function(e,t,a){},67:function(e,t,a){e.exports=a(143)},99:function(e,t){}},[[67,1,2]]]);
//# sourceMappingURL=main.accf9ac8.chunk.js.map